<!DOCTYPE html>
<html>
<head>
	<meta charset='UTF-8'>
	<title>Jekyll update for my blog site | Wenwei's tech Blog</title>
	<link rel='alternate' type='application/rss+xml' title='Wenwei Feed' href='http://weweng.github.io/atom.xml'>
	<meta name='description' content=''/>
	<meta name='keywords' content='Jekyll static site blog'/>
	<meta name='viewport' content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no'>
	<meta name='theme-color' content='#655B54'>
	<link rel='shortcut icon' href='/assets/favicon.ico' type='image/x-icon'> 
	<!--- <link rel='icon' href='/assets/favicon.ico' type='image/x-icon'> --->
<link rel='icon' href='/assets/blogger.png' type='image/x-png'>

	<link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700' rel='stylesheet' type='text/css'>
	<link rel='stylesheet' type='text/css' href='/assets/css/code-highlighter.css' />
<link rel='stylesheet' type='text/css' href='/assets/css/default.min.css' />
<link rel='stylesheet' type='text/css' href='/assets/css/github.css' />
<link rel='stylesheet' type='text/css' href='/assets/css/pure-base-min.css' />
<link rel='stylesheet' type='text/css' href='/assets/css/pure-grids-responsive-min.css' />
<link rel='stylesheet' type='text/css' href='/assets/css/pure-menus-min.css' />
<link rel='stylesheet' type='text/css' href='/assets/css/pure-tables-min.css' />
<link rel='stylesheet' type='text/css' href='/assets/css/social-buttons.css' />
<link rel='stylesheet' type='text/css' href='/assets/css/weweng.css' />


	
</head>
<body>

<div class='pure-g' id='layout'>
    <div class='sidebar pure-u-1 pure-u-md-1-4'>
      <div class='header'>
	<nav class='nav'>
	  <ul class='nav-list'>
	    <li class='nav-item'>
	      <strong> <a href='/workblog.html'>Blog</a> </strong>
	    </li>
<!--
	    <li class='nav-item'>
	      <strong> <a href='/study/index.html'>Study</a> </strong>
	    </li>
	    <li class='nav-item'>
	      <strong> <a href='/projects/index.html'>Projects</a> </strong>
	    </li>
-->
<!--
            <li class='nav-item'>
              <strong> <a href='/services/index.html'>读书笔记</a> </strong>
            </li>
-->
	    <li class='nav-item'>
	      <strong><a href='/aboutme.html'>About Me</a></strong>
	    </li>
	</ul>
	</nav>
	<br> 
	<h1 class='brand-title'>
	  <a href='/index.html'>
		<img src='/assets/img/avatar.png' height='100'/>
	  </a>
	</h1>
      </div>
</div>

<div class='pure-u-1'>
	<div class='content'>
		<section class='post'>
	<header class='post-header'>
		<h2 class='post-title'> Jekyll update for my blog site </h2>
		<p class='post-meta'>
			Posted on <time class='date' datetime='2019-08-12T00:00:00+01:00'>12 Aug 2019</time>
		</p>
	</header>

	<div class='post-description'>
		<p>My blog site was shutdown for quite a while for certain reasons. However I strongly feel this is a good way for me to capture what I learned along the way and share with anyone who might feel helpful for them. Thanks to all people who provided postivie feedback. After clearup the issue and I finally decide to continue working on my blog site. First thing I do is to update my blog development enviroment which is Jekyll, installed in ubuntu 16.04 VM.</p>

<p><img src="/uploads/jekyll.jpg" alt="Jekyll on Ubuntu" /> 
<!--more--></p>
<h2 id="what-is-jekyll">What is Jekyll?</h2>

<p>Jekyll is a very popular tool to build/generate a static web/blog site. It is based on Ruby, which is a script programming language. Ruby library is packaged and distributed as “gem”. Jekyll is one of Ruby’s gem.</p>

<p>If you do a google search “ubuntu 16.04 install jekyll”, you will find a number of links, which have detailed steps, e.g.</p>
<ul>
  <li>https://www.digitalocean.com/community/tutorials/how-to-set-up-a-jekyll-development-site-on-ubuntu-16-04</li>
</ul>

<p>Essentially two steps:</p>

<ol>
  <li>sudo apt-get install ruby ruby-dev make gcc</li>
  <li>sudo gem install jekyll bundler</li>
</ol>

<h2 id="issues-encountered">Issues encountered:</h2>

<h4 id="after-upgrade-jekyll-is-running-version-386">After upgrade, jekyll is running version 3.8.6.</h4>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">weng@weng-u1604:/mnt/vb-win7-share/github/blog<span class="nv">$ </span>gem info jekyll

<span class="k">***</span> LOCAL GEMS <span class="k">***</span>

jekyll <span class="o">(</span>3.8.6, 3.8.5<span class="o">)</span>
    Author: Tom Preston-Werner
    Homepage: https://github.com/jekyll/jekyll
    License: MIT
    Installed at <span class="o">(</span>3.8.6<span class="o">)</span>: /home/weng/.rvm/gems/ruby-2.6.3
                 <span class="o">(</span>3.8.5<span class="o">)</span>: /home/weng/.rvm/gems/ruby-2.6.3

    A simple, blog aware, static site generator.
weng@weng-u1604:/mnt/vb-win7-share/github/blog<span class="nv">$ </span></code></pre></figure>

<p>The new version jekyll deprectes markdown “redcarpet”, so I have to change my _config.yml to below:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"> 
weng@weng-u1604:/mnt/vb-win7-share/github/blog<span class="nv">$ </span><span class="nb">cat </span>_config.yml
...
<span class="c"># Build settings</span>
markdown: kramdown
theme: minima
plugins:
  - jekyll-feed</code></pre></figure>

<h4 id="image-link-rendering-issue">Image link rendering issue</h4>
<p>With _config.yml change, Jekyll is able to rebuild my blog, but failed to render image link like below:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"> 
<span class="o">![</span>image alt text] <span class="o">(</span>/path/to/image/filename.jpg<span class="o">)</span></code></pre></figure>

<p>I look around net, couldn’t find any solution, except that I change to html format :</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"> 
&lt;img <span class="nv">src</span><span class="o">=</span><span class="s2">"/pathto/image/filename.jpg"</span> <span class="nv">alt</span><span class="o">=</span><span class="s2">"alt text"</span><span class="o">&gt;</span></code></pre></figure>

<p>Since I have many existing MD files, which have image links, I ended up to wrote the below small bash script to do the work:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"> 
<span class="c">#!/bin/bash </span>

<span class="nv">files</span><span class="o">=</span><span class="sb">`</span><span class="nb">ls</span> <span class="k">*</span>.md<span class="sb">`</span>
<span class="k">for </span>f <span class="k">in</span> <span class="nv">$files</span>
<span class="k">do
    </span><span class="nb">echo</span> <span class="s2">"============================="</span>
    <span class="nb">echo</span> <span class="s2">"Processing file : </span><span class="nv">$f</span><span class="s2"> "</span>

    <span class="k">while</span> <span class="o">[</span> 1 <span class="o">]</span>
    <span class="k">do 
        </span><span class="nv">todo</span><span class="o">=</span><span class="sb">`</span><span class="nb">grep</span> <span class="nt">-n</span> <span class="s1">'\!\['</span> <span class="nv">$f</span> | head <span class="nt">-1</span> | wc <span class="nt">-l</span><span class="sb">`</span>
        <span class="k">if</span> <span class="o">[</span> <span class="nv">$todo</span> <span class="nt">-eq</span> 1 <span class="o">]</span>
	<span class="k">then
	   </span><span class="nv">linenum</span><span class="o">=</span><span class="sb">`</span><span class="nb">grep</span> <span class="nt">-n</span> <span class="s1">'\!\['</span> <span class="nv">$f</span> | head <span class="nt">-1</span> | awk <span class="nt">-F</span>: <span class="s1">'{print $1}'</span> <span class="sb">`</span>
	   <span class="nv">line</span><span class="o">=</span><span class="sb">`</span><span class="nb">grep</span> <span class="s1">'\!\['</span> <span class="nv">$f</span> | head <span class="nt">-1</span> <span class="sb">`</span>
	   <span class="c"># process one line</span>
	   <span class="nb">echo</span> <span class="s2">"Process one line : </span><span class="nv">$line</span><span class="s2">, replacing with "</span>
	   <span class="nv">alt_text</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$line</span> | awk <span class="nt">-F</span><span class="s1">'] '</span> <span class="s1">'{print $1}'</span> | sed <span class="s1">'s/\!\[//g '</span> <span class="sb">`</span>
	   <span class="nv">img_file</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$line</span> | awk <span class="nt">-F</span><span class="s1">'] '</span> <span class="s1">'{print $2}'</span> | sed <span class="s1">'s/(//g'</span> | sed <span class="s1">'s/)//g'</span> <span class="sb">`</span>

	   <span class="c"># new line format is like &lt;img src="/pathto/image/filename.jpg" alt=" alt text"&gt; </span>
	   <span class="nv">newline</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="s2">"&lt;img src=</span><span class="se">\"</span><span class="nv">$img_file</span><span class="se">\"</span><span class="s2"> alt=</span><span class="se">\"</span><span class="nv">$alt_text</span><span class="se">\"</span><span class="s2">&gt; "</span><span class="sb">`</span>
	   <span class="nb">echo</span> <span class="nv">$newline</span>
	   <span class="c">#insert line line after current line</span>
	   <span class="nv">cmd</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="s2">"sed -i '</span><span class="nv">$linenum</span><span class="s2"> a </span><span class="nv">$newline</span><span class="s2"> ' </span><span class="nv">$f</span><span class="s2"> "</span> <span class="sb">`</span>
	   <span class="nb">eval</span> <span class="nv">$cmd</span>
	   <span class="nb">echo</span> <span class="s2">".........."</span>
	   <span class="c">#delete old line</span>
	   <span class="nv">cmd</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo </span>sed <span class="nt">-i</span> <span class="se">\'</span><span class="k">${</span><span class="nv">linenum</span><span class="k">}</span>d<span class="se">\'</span> <span class="nv">$f</span> <span class="sb">`</span>
	   <span class="nb">eval</span> <span class="nv">$cmd</span>
	   sync
         <span class="k">else
	   </span><span class="nb">echo</span> <span class="s2">" done!"</span>    
	   <span class="nb">echo</span> <span class="s2">"============================="</span>
           <span class="nb">break	   
         </span><span class="k">fi
    done
done</span></code></pre></figure>

<h4 id="main-page-recent-posts">Main page recent posts</h4>

<p>The main page most recent posts are not shown, which I haven’t fixed it. Now I simply change to show all posts sorted by date.</p>


	</div>

<!--	
	<div class='share-button-container'>
		<p>Like it? Share it!</p>
		<div class='share-button share-button-twitter' data-share-url="http://weweng.github.io/2019/08/12/Jekyll-Update-blog-site.html">
			<div clas='box'>
				<a href="https://twitter.com/share?url=http://weweng.github.io%2F2019%2F08%2F12%2FJekyll-Update-blog-site.html&text=Jekyll update for my blog site&via=weweng" target='_blank'>
					<span class='share'>Tweet</span>
					<span class='count'>0</span>
				</a>
			</div>
		</div>

		<div class="share-button share-button-facebook" data-share-url="http://weweng.github.io/2019/08/12/Jekyll-Update-blog-site.html">
			<div class="box">
				<a href="https://www.facebook.com/sharer/sharer.php?u=http://weweng.github.io%2F2019%2F08%2F12%2FJekyll-Update-blog-site.html">
					<span class='share'>Share</span>
					<span class='count'>0</span>
				</a>
			</div>
		</div>
	</div>
-->

</section>

<div id='comments'>
	<div id='disqus_thread'></div>
	<script type='text/javascript'>
		var disqus_shortname = 'wewenggithubio';
		(function() {
			var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
			dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
			(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
		})();
	</script>

	<noscript>Please enable JavaScript to view the comments</noscript>
</div>
<script type='text/javascript' src='/assets/js/StaticShareButtons.js'></script>


	</div>

	<footer class='footer'>
		<span>Copyright 2015-2017, Wenwei Weng</span>
	</footer>
</div>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-62997612-1', 'auto');
  ga('send', 'pageview');

</script>


<script type="text/javascript">
// Open external links in new tab
(window.onload = function(){
	var links = document.links;

	for(i=0; i<=links.length -1; i++){
		if(links[i].hostname != window.location.hostname){
			links[i].target = '_blank';
		}
	}
})();
</script>
</body>
</html>
